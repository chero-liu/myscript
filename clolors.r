palette_list <- list(
 self = c('#DF0A1F','#1C5BA7','#019E73','#ED621B','#E477C1','#9F195B','#FFC107','#6A1B9A','#00BFA5','#2E7D32'),
 singler =  c(
     "#7FC97F","#BEAED4","#FDC086","#386CB0","#F0027F","#BF5B17",
     "#666666","#1B9E77","#7570B3","#66A61E", "#E6AB02","#A6761D",
     "#A6CEE3","#B2DF8A","#FB9A99","#E31A1C","#FF7F00","#6A3D9A",
     "#8DA0CB","#4DAF4A","#984EA3","#c6c386","#999999","#66C2A5",
     "#FC8D62","#A6D854","#FFD92F","#BEBADA","#FB8072","#80B1D3",
     "#FDB462","#BC80BD","#B3B3B3","#33A02C","#B3DE69","#4038b0",
     "#ee7576","#e94749","#E78AC3","#ff0000","#A65628","#d80172",
     "#F781BF","#D95F02","#E7298A","#1F78B4","#FDBF6F","#CAB2D6",
     "#B15928","#FBB4AE", "#B3CDE3",'#0173b2','#de8f05','#029e73',
     '#d55e00','#cc78bc','#ca9161','#fbafe4','#949494','#ece133',
     '#56b4e9',"#00AFBB","#E7B800","#FC4E07","#FFDB6D","#C4961A",
     "#F4EDCA","#D16103","#C3D7A4","#52854C","#4E84C4","#293352"),
 blindless = c(
     "#7FC97F", "#BEAED4", "#FDC086", "#FFFF99", "#386CB0", "#F0027F",
     "#BF5B17", "#1B9E77", "#D95F02", "#7570B3", "#66A61E", "#E6AB02",
     "#A6761D", "#A6CEE3", "#1F78B4", "#B2DF8A", "#33A02C", "#FB9A99",
     "#E31A1C", "#FDBF6F", "#FF7F00", "#CAB2D6", "#6A3D9A", "#B15928",
     "#FBB4AE", "#B3CDE3", "#BC80BD", "#CCEBC5", "#DECBE4", "#FED9A6",
     "#FFFFCC", "#E5D8BD", "#FDDAEC", "#F2F2F2", "#B3E2CD", "#FDCDAC",
     "#CBD5E8", "#F4CAE4", "#E6F5C9", "#FFF2AE", "#F1E2CC", "#CCCCCC",
     "#E41A1C", "#377EB8", "#984EA3", "#FFFF33", "#A65628", "#F781BF",
     "#999999", "#FFED6F", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3",
     "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", "#8DD3C7", "#FFFFB3",
     "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
     "#D9D9D9","#666666"),
 customecol2 = c(
    "#7fc97f","#beaed4","#fdc086","#386cb0","#f0027f","#a34e3b",
    "#666666","#1b9e77","#d95f02","#7570b3","#d01b2a","#43acde",
    "#efbd25","#492d73","#cd4275","#2f8400","#d9d73b","#aed4ff",
    "#ecb9e5","#813139","#743fd2","#434b7e","#e6908e","#214a00",
    "#ef6100","#7d9974","#e63c66","#cf48c7","#ffe40a","#a76e93",
    "#d9874a","#adc64a","#5466df","#d544a1","#54d665","#5e99c7",
    "#006874","#d2ad2c","#b5d7a5","#9e8442","#4e1737","#e482a7",
    "#6f451d","#2ccfe4","#ae6174","#a666be","#a32b2b","#ffff99",
    "#3fdacb","#bf5b17"),
  group_color = c("#d01b2a","#43acde",
    "#efbd25","#492d73","#cd4275","#2f8400","#d9d73b","#aed4ff",
    "#ecb9e5","#813139","#743fd2","#434b7e","#e6908e","#214a00",
    "#ef6100","#7d9974","#e63c66","#cf48c7","#ffe40a","#a76e93",
    "#d9874a","#adc64a","#5466df","#d544a1","#54d665","#5e99c7",
    "#006874","#d2ad2c","#b5d7a5","#9e8442","#4e1737","#e482a7",
    "#6f451d","#2ccfe4","#ae6174","#a666be","#a32b2b","#ffff99",
    "#3fdacb","#bf5b17"),
 monocle = c(
   "#016edb", "#09658A", "#B4246E", "#FF9A21", "#FBC83C", "#ff42ef",
   "#216407", "#ff0000", "#483F84", "#995432", "#9834E7", "#35B5E2",
   "#A71206", "#717E8D", "#7762F0", "#C39CFB", "#FFFA2C", "#00FF00",
   "#CAC379", "#8B8A1D", "#FF8380", "#00FFFF", "#C0C0C0", "#0118FA",
   "#000000"
 ),
 col50 =  c(
      "#982f29", "#5ddb53", "#8b35d6", "#a9e047", "#4836be",
      "#e0dc33", "#d248d5", "#61a338", "#9765e5", "#69df96",
      "#7f3095", "#d0d56a", "#371c6b", "#cfa738", "#5066d1",
      "#e08930", "#6a8bd3", "#da4f1e", "#83e6d6", "#df4341",
      "#6ebad4", "#e34c75", "#50975f", "#d548a4", "#badb97",
      "#b377cf", "#899140", "#564d8b", "#ddb67f", "#292344",
      "#d0cdb8", "#421b28", "#5eae99", "#a03259", "#406024",
      "#e598d7", "#343b20", "#bbb5d9", "#975223", "#576e8b",
      "#d97f5e", "#253e44", "#de959b", "#417265", "#712b5b",
      "#8c6d30", "#a56c95", "#5f3121", "#8f846e", "#8f5b5c"),
 ditto = c(
     "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2",
     "#D55E00", "#CC79A7", "#666666", "#AD7700", "#1C91D4",
     "#007756", "#D5C711", "#005685", "#A04700", "#B14380",
     "#4D4D4D", "#FFBE2D", "#80C7EF", "#00F6B3", "#F4EB71",
     "#06A5FF", "#FF8320", "#D99BBD", "#8C8C8C"),
 cold = c(
     "#1660A7","#FF6A00","#219418","#CD0C18","#814BB2","#794339",
     "#5ddb53","#5066d1","#FF0000","#F0E442","#4836be","#EE6677",
     "#DC59B6","#CC79A7","#982f29","#AFB400","#11B3C6","#292344",
     "#E69F00","#AA3377","#009E73","#576e8b","#0072B2","#D55E00",
     "#00AFBB","#00FFFF","#4477AA","#228833","#CCBB44","#66CCEE",
      "#56B4E9","#BBBBBB"),
 Buen = c(
     "#00441B", "#46A040", "#00AF99", "#FFC179", "#98D9E9", "#F6313E",
     "#FFA300", "#C390D4", "#FF5A00", "#DBA13A", "#7D7D7D", "#4B4B4B",
     "#8F1336", "#0081C9", "#001588", "#490C65", "#F26C64"),
 pal27 = c("#E31A1C","#3182BD","#FEB24C","#CE1256","#31A354","#91003F",
           "#756BB1","#C51B8A","#DE2D26","#7FCDBB","#1C9099","#FC9272",
           "#ADDD8E","#FA9FB5","#43A2CA","#2CA25F","#8856A7","#E34A33",
           "#023858","#636363","#FEC44F","#253494","#A6BDDB","#C994C7",
           "#D95F0E","#2C7FB8","#FDBB84"),
 pal19 = c("#FF6F00FF","#225EA8","#FED439FF","#197EC0FF","#C71000FF",
           "#FD8CC1FF","#370335FF","#008EA0FF","#8A4198FF","#FC4E2A",
           "#709AE1FF","#71D0F5FF","#91331FFF","#C80813FF","#46732EFF",
           "#FF6348FF","#D5E4A2FF","#ADE2D0FF","#1A9993FF"),
 UKBB = c(
   "#00441B", "#46A040", "#00AF99", "#FFC179", "#98D9E9", "#F6313E",
   "#8F1336", "#0081C9", "#001588", "#490C65", "#A65AC2", "#FF81AF",
   "#CDA2DB", "#FF5A00", "#FFCE00", "#FFA300", "#FF7900", "#FFA300" ),
 TF1 = c(
   "#F6313E", "#46A040", "#0081C9", "#A65AC2", "#FFA300",  "#FFFF32",
   "#89774A", "#FF6A80", "#999999", "#0DB2AA", "#001588", "#00441B",
   "#CDA2DB", "#98D9E9", "#FF9999", "#FFC966", "#A9FBA9" ),
 colx22 = c(
     '#e6194b', '#3cb44b', '#ffe119', '#4363d8', '#f58231', '#911eb4',
     '#46f0f0', '#f032e6', '#bcf60c', '#fabebe', '#008080', '#e6beff',
     '#9a6324', '#fffac8', '#800000', '#aaffc3', '#808000', '#ffd8b1',
     '#000075', '#808080', '#4f34ff', '#f340F0'),
 paired = c(
     "#A6CEE3", "#1F78B4", "#B2DF8A", "#33A02C", "#FB9A99", "#E31A1C",
     "#FDBF6F", "#FF7F00", "#CAB2D6", "#6A3D9A", "#FFFF99", "#B15928"),
 simpson = c("#FED439FF","#709AE1FF","#8A9197FF","#D2AF81FF","#FD7446FF",
             "#D5E4A2FF","#197EC0FF","#CC4C02","#46732EFF","#71D0F5FF",
             "#370335FF","#075149FF","#C80813FF","#91331FFF","#1A9993FF",
             "#FD8CC1FF"),
 tableau10medium = c("#729ECE", "#FF9E4A", "#67BF5C", "#ED665D",
                     "#AD8BC9", "#A8786E", "#ED97CA", "#A2A2A2",
                     "#CDCC5D", "#6DCCDA"),
 colorblind10 = c("#006BA4", "#FF800E", "#ABABAB", "#595959",
                  "#5F9ED1", "#C85200", "#898989", "#A2C8EC",
                  "#FFBC79", "#CFCFCF"),
 greenorange12 = c("#32A251", "#ACD98D", "#FF7F0F", "#FFB977",
                   "#3CB7CC", "#98D9E4", "#B85A0D", "#FFD94A",
                   "#39737C", "#86B4A9", "#82853B", "#CCC94D"),
alphabet = c(
  "#F0A0FF", "#0075DC", "#993F00", "#4C005C", "#191919", "#005C31",
  "#2BCE48", "#FFCC99", "#808080", "#94FFB5", "#8F7C00", "#9DCC00",
  "#C20088", "#003380", "#FFA405", "#FFA8BB", "#426600", "#FF0010",
  "#5EF1F2", "#00998F", "#E0FF66", "#740AFF", "#990000", "#FFFF80",
  "#FFE100", "#FF5005"
),
alphabet2 = c(
  "#AA0DFE", "#3283FE", "#85660D", "#782AB6", "#565656", "#1C8356",
  "#16FF32", "#F7E1A0", "#E2E2E2", "#1CBE4F", "#C4451C", "#DEA0FD",
  "#FE00FA", "#325A9B", "#FEAF16", "#F8A19F", "#90AD1C", "#F6222E",
  "#1CFFCE", "#2ED9FF", "#B10DA1", "#C075A6", "#FC1CBF", "#B00068",
  "#FBE426", "#FA0087"
),
glasbey = c(
  "#0000FF", "#FF0000", "#00FF00", "#000033", "#FF00B6", "#005300",
  "#FFD300", "#009FFF", "#9A4D42", "#00FFBE", "#783FC1", "#1F9698",
  "#FFACFD", "#B1CC71", "#F1085C", "#FE8F42", "#DD00FF", "#201A01",
  "#720055", "#766C95", "#02AD24", "#C8FF00", "#886C00", "#FFB79F",
  "#858567", "#A10300", "#14F9FF", "#00479E", "#DC5E93", "#93D4FF",
  "#004CFF", "#F2F318"
),
polychrome = c(
  "#5A5156", "#E4E1E3", "#F6222E", "#FE00FA", "#16FF32", "#3283FE",
  "#FEAF16", "#B00068", "#1CFFCE", "#90AD1C", "#2ED9FF", "#DEA0FD",
  "#AA0DFE", "#F8A19F", "#325A9B", "#C4451C", "#1C8356", "#85660D",
  "#B10DA1", "#FBE426", "#1CBE4F", "#FA0087", "#FC1CBF", "#F7E1A0",
  "#C075A6", "#782AB6", "#AAF400", "#BDCDFF", "#822E1C", "#B5EFB5",
  "#7ED7D1", "#1C7F93", "#D85FF7", "#683B79", "#66B0FF", "#3B00FB"
),
stepped = c(
  "#990F26", "#B33E52", "#CC7A88", "#E6B8BF", "#99600F", "#B3823E",
  "#CCAA7A", "#E6D2B8", "#54990F", "#78B33E", "#A3CC7A", "#CFE6B8",
  "#0F8299", "#3E9FB3", "#7ABECC", "#B8DEE6", "#3D0F99", "#653EB3",
  "#967ACC", "#C7B8E6", "#333333", "#666666", "#999999", "#CCCCCC" 
),
cellchat = c("#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", 
    "#F29403", "#F781BF", "#BC9DCC", "#A65628", "#54B0E4", 
    "#222F75", "#1B9E77", "#B2DF8A", "#E3BE00", "#FB9A99", 
    "#E7298A", "#910241", "#00CDD1", "#A6CEE3", "#CE1261", 
    "#5E4FA2", "#8CA77B", "#00441B", "#DEDC00", "#B3DE69", 
    "#8DD3C7", "#999999"
    ),
cellchat_custom = c("#EC5757", "#377EB8", "#4DAF4A", "#984EA3", 
    "#F29403", "#F781BF", "#BC9DCC", "#A65628", "#54B0E4", 
    "#222F75", "#1B9E77", "#B2DF8A", "#E3BE00", "#FB9A99", 
    "#E7298A", "#910241", "#00CDD1", "#A6CEE3", "#CE1261", 
    "#5E4FA2", "#8CA77B", "#00441B", "#DEDC00", "#B3DE69", 
    "#8DD3C7", "#999999"
    ),
colx22_custom = c(
    '#EC5379', '#3cb44b', '#ffe119', '#4363d8', '#f58231', '#911eb4',
    '#46f0f0', '#f032e6', '#bcf60c', '#fabebe', '#008080', '#e6beff',
    '#9a6324', '#fffac8', '#800000', '#aaffc3', '#808000', '#ffd8b1',
    '#000075', '#808080', '#4f34ff', '#f340F0'
    ),
customecol2_light = c("#99D499FF", "#CBBEDDFF", "#FDCD9EFF", "#6089C0FF", "#F33599FF", "#B57162FF",
                    "#858585FF", "#49B192FF", "#E17F35FF", "#918DC2FF", "#D94955FF", "#69BDE5FF",
                    "#F2CA51FF", "#6D578FFF", "#D76891FF", "#599D33FF", "#E1DF62FF", "#BEDDFFFF",
                    "#F0C7EAFF", "#9A5A61FF", "#9065DBFF", "#696F98FF", "#EBA6A5FF", "#4D6E33FF",
                    "#F28133FF", "#97AD90FF", "#EB6385FF", "#D96DD2FF", "#FFE93BFF", "#B98BA9FF",
                    "#E19F6EFF", "#BDD16EFF", "#7685E5FF", "#DD69B4FF", "#76DE84FF", "#7EADD2FF",
                    "#338690FF", "#DBBD56FF", "#C4DFB7FF", "#B19D68FF", "#71455FFF", "#E99BB9FF",
                    "#8C6A4AFF", "#56D9E9FF", "#BE8190FF", "#B885CBFF", "#B55555FF", "#FFFFADFF",
                    "#65E1D5FF", "#CC7C45FF" ),
cellpaper_custom = c("#C1629D","#F36C65","#76B9CF","#C9A581","#EEB053","#94CFBF","#EAED70","#CD96BE","#CDDE8B","#E9B19C","#ED4B43","#F39881","#AA4286","#3975E3","#77A879","#B589BC","#ECB888","#FC7440","#A032CB","#CD8AB1","#E9D6EB","#76A1EC","#A3C4A5","#EED785","#D4B595","#EFE0E7","#EEBED6","#F7D39B","#CD7560","#7FC28E","#F9CABE","#C76DA8","#FEF6AE","#6276B2","#E69D8E","#D9706F","#C5D9DF","#E16DB7","#908EBC","#AF88BB","#DEDBEE","#F07590","#DFB9D5","#B099B5","#5394C3","#C5B8B0","#917393","#97CADC","#DBEBF7","#84D7F7","#D4EEF6","#F5BCC9","#5EB4F3","#F7F4B7","#6F89D3","#50C2FB","#EA94CD","#D8B6F7","#EFC1EC"),

group_default = c("#223D6C","#D20A13","#FFD121","#088247","#B037C4",
                  "#58CDD9","#7A142C","#5D90BA","#431A3D","#91612D",
                  "#6E568C","#E0367A","#D8D155","#64495D","#7CC767"),
tableau20 = c("#1F77B4", "#AEC7E8", "#FF7F0E", "#FFBB78", "#2CA02C", "#98DF8A",
     "#D62728", "#FF9896", "#9467BD", "#C5B0D5", "#8C564B", "#C49C94",
     "#E377C2", "#F7B6D2", "#7F7F7F", "#C7C7C7", "#BCBD22", "#DBDB8D",
     "#17BECF", "#9EDAE5"),
cellpaper = c(
    "#D492BC","#F8ABA7","#A4D0DF","#DEC8B1","#F4CA8C","#C4E5DC","#F3F5AE","#E3C3DA","#E4EDBF","#F7E3DB",
    "#F48F89","#F9CABE","#C76DA8","#77A1EC","#A3C4A5","#FC7440","#A032CB","#CB9FD0","#EED785","#CBA57E","#CD7560","#7FC28E","#6276B2","#E16DB7","#908EBC","#AF88BB","#DEDBEE","#639EC8","#84D7F7","#917393")
)

addColorToDataFrame <- function(data, colname, palette = 'customecol2') {
  if (!colname %in% names(data)) {
    stop("The specified colname does not exist in the data frame.")
  }
  
  if(is.null(levels(data[[colname]]))){
    unique_values <- unique(data[[colname]])
  }else{
    unique_values <- levels(data[[colname]])
  }
  
  colors <- palette_list[[palette]][1:length(unique_values)]
  color_map <- setNames(colors, unique_values)
  print(color_map)
  data[,paste0(colname,"_col")] <- color_map[as.character(data[[colname]])]
  return(data)
}

